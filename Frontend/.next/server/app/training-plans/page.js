(()=>{var e={};e.id=794,e.ids=[794],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},5100:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>u,originalPathname:()=>d,pages:()=>p,routeModule:()=>g,tree:()=>c}),r(7167),r(37),r(996);var n=r(170),a=r(5002),o=r(3876),s=r.n(o),i=r(6299),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["training-plans",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7167)),"C:\\Users\\nieva\\OneDrive\\Desktop\\Proyecto-Gym\\El_Gaalpon_de_Jose\\Frontend\\src\\app\\training-plans\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,37)),"C:\\Users\\nieva\\OneDrive\\Desktop\\Proyecto-Gym\\El_Gaalpon_de_Jose\\Frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],p=["C:\\Users\\nieva\\OneDrive\\Desktop\\Proyecto-Gym\\El_Gaalpon_de_Jose\\Frontend\\src\\app\\training-plans\\page.tsx"],d="/training-plans/page",u={require:r,loadChunk:()=>Promise.resolve()},g=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/training-plans/page",pathname:"/training-plans",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6968:(e,t,r)=>{Promise.resolve().then(r.bind(r,1250))},1250:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var n=r(7247),a=r(5223),o=r(8964),s=r(9741),i=r.n(s),l=r(31),c=r(4946);let p=()=>{let{user:e}=(0,o.useContext)(c.S),[t,r]=(0,o.useState)([]),[s,p]=(0,o.useState)(null),[d,u]=(0,o.useState)(!0),[g,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{u(!0);try{let e=await (0,a.pE)();r(e)}catch(e){p("Error fetching training plans")}finally{u(!1)}})()},[]);let x=async e=>{(await l.Z.fire({title:"Hey!",text:"Are you sure you want to delete this plan?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",customClass:{popup:"bg-[#222222] text-white",title:"text-[#B0E9FF]",confirmButton:"bg-[#B0E9FF] text-[#222222] hover:bg-[#6aa4bb] py-2 px-4 border-none",cancelButton:"bg-gray-500 text-white hover:bg-gray-600 py-2 px-4 border-none"},buttonsStyling:!1})).isConfirmed&&await (0,a.Wb)(e)&&(r(t.filter(t=>t.id!==e)),l.Z.fire({title:"Great!",text:"The plan has been deleted successfully!",icon:"success",customClass:{popup:"bg-[#222222] text-white",title:"text-[#B0E9FF]",confirmButton:"bg-[#B0E9FF] text-[#222222] hover:bg-[#6aa4bb] py-2 px-4 border-none"},buttonsStyling:!1}))},m=e=>{h(e)},b=()=>{h(null)};return d?n.jsx("div",{children:"Loading training plans..."}):s?n.jsx("div",{className:"text-red-500",children:s}):(0,n.jsxs)("div",{className:"min-h-screen bg-black text-white flex flex-col items-center p-6",children:[n.jsx("div",{className:"text-center mb-6",children:(0,n.jsxs)("h1",{className:"text-3xl font-extrabold",children:["My ",n.jsx("span",{className:"text-red-600",children:"Training Plans"})]})}),n.jsx("div",{className:"text-center container mx-auto p-8 bg-zinc-950 shadow-lg",children:0===t.length?n.jsx("p",{children:"No training plans available"}):n.jsx("ul",{children:t.map(t=>(0,n.jsxs)("li",{className:"bg-zinc-900 p-4 rounded-lg shadow-md mb-4 flex justify-between items-center",children:[n.jsx("h2",{className:"text-lg font-semibold",children:t.description}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[n.jsx("button",{onClick:()=>m(t.file),className:"bg-gray-700 text-white py-2 px-4 rounded hover:bg-gray-800 transition",children:"View Plan"}),e?.role==="coach"&&n.jsx("button",{onClick:()=>x(t.id),className:"bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition",children:"Delete Plan"})]})]},t.id))})}),n.jsx(i(),{isOpen:!!g,onRequestClose:b,className:"flex items-center justify-center",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:(0,n.jsxs)("div",{className:"bg-white p-4 rounded",children:[g&&n.jsx("img",{src:g,alt:"Training Plan",className:"max-w-full h-auto"}),n.jsx("button",{onClick:b,className:"mt-4 bg-gray-500 text-white py-1 px-3 rounded hover:bg-gray-600",children:"Close"})]})})]})}},5223:(e,t,r)=>{"use strict";async function n(e){try{let t=localStorage.getItem("token");if(!t)throw Error("Token no disponible");let r=await fetch("http://localhost:3000/training-plans",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({description:e})});if(!r.ok){let e=await r.json();throw console.error("Server error:",e),Error(`Error: ${r.status} ${r.statusText}`)}let n=await r.json();return console.log("Server response",n),n}catch(e){return console.error("Error when creating plan",e),null}}async function a(e,t){try{let r=localStorage.getItem("token");if(!r)throw Error("Token no disponible");if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(t.type)||t.size>204800)throw Error("El archivo debe ser una imagen en formato jpg, jpeg, png o webp y menor a 200KB");let n=new FormData;n.append("file",t);let a=await fetch(`http://localhost:3000/files/uploadImage/${e}`,{method:"PATCH",headers:{Authorization:`Bearer ${r}`},body:n});if(!a.ok){let e=await a.json();throw console.error("Server error:",e),Error(`Error: ${a.status} ${a.statusText}`)}let o=await a.json();return console.log("Server response",o),o}catch(e){return console.error("Error when uploading image",e),null}}r.d(t,{Ix:()=>a,Wb:()=>o,he:()=>n,pE:()=>s});let o=async e=>{try{let t=localStorage.getItem("token"),r=await fetch(`http://localhost:3000/training-plans/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(!r.ok){let e=await r.text();throw Error(`Error: ${r.status} ${r.statusText}, Details: ${e}`)}return!0}catch(e){console.error("Error al eliminar el plan de entrenamiento:",e),alert("Error al eliminar el plan de entrenamiento")}},s=async()=>{try{let e=localStorage.getItem("token"),t=await fetch("http://localhost:3000/training-plans",{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error(`Error: ${t.status} ${t.statusText}`);let r=await t.json();return console.log("Training plans data:",r),r}catch(e){console.error("Error obtaining training plans:",e),alert("Error obtaining training plans")}}},7167:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(2051),a=r(4801);function o(){return n.jsx(a.Z,{})}r(6269)},4801:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(2051);let a=(0,r(5347).createProxy)(String.raw`C:\Users\nieva\OneDrive\Desktop\Proyecto-Gym\El_Gaalpon_de_Jose\Frontend\src\components\TrainingPlans\TrainingPlans.tsx#default`);function o(){return n.jsx(a,{})}r(6269)},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(4564);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,n.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[379,568,564,741,763],()=>r(5100));module.exports=n})();
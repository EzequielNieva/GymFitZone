(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64],{3497:function(e,t,r){Promise.resolve().then(r.bind(r,9453))},2926:function(e,t,r){"use strict";var o=r(7437);r(2265);var s=r(2574);t.Z=()=>(0,o.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-black",children:(0,o.jsx)(s.p2,{height:80,width:80,color:"#FF0000",ariaLabel:"loading",visible:!0})})},2177:function(e,t,r){"use strict";r.d(t,{S:function(){return d},d:function(){return h}});var o=r(7437),s=r(9261),n=r(2265),a=r(4474),l=r(5515),c=r.n(l),i=r(9376),u=r(605);let d=(0,n.createContext)({user:null,setUser:()=>{},isLogged:!1,setIsLogged:()=>{},signIn:async()=>!1,signUp:async e=>({success:!1,errorMessage:""}),logOut:()=>{},imgUrl:null,setImgUrl:()=>{}}),h=e=>{let{children:t}=e,[r,l]=(0,n.useState)(null),[h,g]=(0,n.useState)(!1),[m,f]=(0,n.useState)(null);(0,i.useRouter)();let{data:p,status:w}=(0,u.useSession)();console.log("\uD83D\uDE80 ~ UserProvider ~ status:",w),console.log("\uD83D\uDE80 ~ UserProvider ~ session:",p);let x=async e=>{try{let t;if("provider"in e)return!0;{let r=await (0,s.Qd)(e);t=r?{user:r.user,token:r.token}:null}if(t&&t.token){let e=(0,a.o)(t.token),r=e.roles,o=e.id,n={...t.user,role:r,id:o,token:t.token},c=await (0,s.FQ)(o,t.token);return c&&(l({...n,...c}),f(c.imgUrl||null),localStorage.setItem("imgUrl_".concat(o),c.imgUrl||"")),localStorage.setItem("user",JSON.stringify(n)),localStorage.setItem("token",t.token),g(!0),!0}return console.warn("No se pudo iniciar sesi\xf3n, datos no v\xe1lidos:",t),!1}catch(e){return e instanceof Error?console.error("Error durante el login:",e.message):console.error("Error inesperado durante el login:",e),!1}},E=async e=>{try{console.log("Llamando a postSignUp con:",e);let t=await (0,s.J)(e);if(console.log("Respuesta recibida en signUp:",t),t&&t.user&&t.user.id)return console.log("Usuario registrado correctamente:",t.user),await x({email:e.email,password:e.password}),f(t.user.imgUrl),{success:!0};return console.log("La respuesta no contiene el usuario o el ID:",t),{success:!1,errorMessage:"No se pudo obtener el ID del usuario."}}catch(e){return console.error("Error en signUp:",e),{success:!1,errorMessage:e instanceof Error?e.message:"Error desconocido en el registro"}}},j=async()=>{let e=null==r?void 0:r.id;e&&localStorage.removeItem("imgUrl_".concat(e)),localStorage.removeItem("user"),localStorage.removeItem("token"),c().fire({title:"Come back soon!",text:"You are logged out!",icon:"success",confirmButtonText:"Great",customClass:{popup:"bg-black text-white",title:"text-red-600",confirmButton:"bg-red-600 text-white hover:bg-red-700 py-2 px-4 border-none rounded-md"},buttonsStyling:!1}),l(null),g(!1),f(null)};return(0,n.useEffect)(()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("token");if(e&&t){let r=JSON.parse(e);try{let e=(0,a.o)(t),o=e.roles,s=r.id,n=localStorage.getItem("imgUrl_".concat(s));l({...r,role:o,id:e.id}),f(n||null),g(!0)}catch(e){console.warn("Error al decodificar el token:",e)}}},[]),(0,o.jsx)(d.Provider,{value:{user:r,setUser:l,isLogged:h,setIsLogged:g,signIn:x,signUp:E,logOut:j,imgUrl:m,setImgUrl:f},children:t})}},4308:function(e,t,r){"use strict";r.d(t,{VG:function(){return o},mv:function(){return s},wC:function(){return n}});let o=async()=>{try{let e=await fetch("http://localhost:3000/class",{method:"GET"});if(!e.ok)throw Error("Error: ".concat(e.status," ").concat(e.statusText));let t=await e.json();return console.log("Class data:",t),t}catch(e){console.error("Error fetching class data:",e)}},s=async e=>{try{let t=await fetch("http://localhost:3000/class",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Error: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Error al crear la clase:",e),e}};async function n(e){try{let t=await fetch("http://localhost:3000/classRegistration/user/".concat(e));if(!t.ok)throw Error("Error en la solicitud: ".concat(t.status));return await t.json()}catch(e){return console.error("Error al obtener el registro de clases:",e),null}}},9261:function(e,t,r){"use strict";async function o(e){try{if(!e.email||!e.password)return console.error("Email y contrase\xf1a son obligatorios"),null;let t=await fetch("http://localhost:3000/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw console.error("Error del servidor:",e),Error("Error: ".concat(t.status," ").concat(t.statusText))}return await t.json()}catch(e){return e instanceof Error?console.error("Error durante la solicitud de inicio de sesi\xf3n:",e.message):console.error("Error inesperado:",e),null}}async function s(e){try{console.log("Iniciando la solicitud de registro al backend");let t=await fetch("http://localhost:3000/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw console.error("Error del servidor:",e),Error("Error: ".concat(t.status," ").concat(t.statusText))}let r=await t.json();return console.log("Respuesta del servidor:",r),r}catch(e){return console.error("Error durante el registro:",e),null}}r.d(t,{FQ:function(){return l},J:function(){return s},Qd:function(){return o},Rf:function(){return n},wc:function(){return a}});let n=async()=>{let e=localStorage.getItem("token"),t=await fetch("http://localhost:3000/users",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){let e=await t.json();throw Error("HTTP error! Status: ".concat(t.status,", Message: ").concat(e.message))}return await t.json()},a=async(e,t)=>{let r=localStorage.getItem("token");if(!r)throw Error("Token no encontrado");let o=await fetch("http://localhost:3000/users/changeRole/".concat(e,"?role=").concat(t),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(!o.ok)throw Error((await o.json()).message||"Error desconocido al cambiar el rol");return await o.json()},l=async(e,t)=>{try{let r=await fetch("http://localhost:3000/users/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}});if(r.ok)return await r.json();return console.error("Error fetching user data:",r.statusText),null}catch(e){return console.error("Error fetching user data:",e),null}}},9453:function(e,t,r){"use strict";var o=r(7437),s=r(2265),n=r(2177),a=r(4308),l=r(2926);t.default=()=>{let{user:e}=(0,s.useContext)(n.S),t=null==e?void 0:e.id;return(0,o.jsx)("div",{className:"p-4",children:t?(0,o.jsx)(c,{userId:t}):(0,o.jsx)("p",{className:"text-white",children:"User id not found"})})};let c=e=>{let{userId:t}=e,[r,n]=(0,s.useState)([]),[c,i]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{(async()=>{let e=await (0,a.wC)(t);e&&n(e),i(!1)})()},[t]),c)?(0,o.jsx)(l.Z,{}):(0,o.jsxs)("div",{className:"bg-black p-6 rounded-lg shadow-lg",children:[(0,o.jsx)("h2",{className:"text-white text-2xl font-bold mb-4",children:"Reserved Classes"}),r.length>0?(0,o.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:r.map(e=>(0,o.jsxs)("div",{className:"bg-zinc-900 p-3 rounded-lg shadow-md relative",children:[(0,o.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-28 object-cover rounded-t-lg"}),(0,o.jsxs)("div",{className:"p-2",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-red-400",children:e.name}),(0,o.jsxs)("div",{className:"text-white mt-1",children:[(0,o.jsxs)("span",{className:"text-sm",children:["Day: ",e.day]}),(0,o.jsx)("br",{}),(0,o.jsxs)("span",{className:"text-sm",children:["Duration: ",e.duration]}),(0,o.jsx)("br",{}),(0,o.jsxs)("span",{className:"text-sm",children:["Time: Start: ",e.starttime," - End: ",e.endtime]})]})]}),(0,o.jsx)("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:e.status})]},e.id))}):(0,o.jsx)("div",{className:"container mx-auto p-8 bg-zinc-950 shadow-lg",children:(0,o.jsx)("p",{className:"text-white",children:"There's no reservated classes"})})]})}}},function(e){e.O(0,[461,571,598,840,971,117,744],function(){return e(e.s=3497)}),_N_E=e.O()}]);